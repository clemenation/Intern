#{extends 'main.html' /}
#{set title:'Update Profile' /}

<div class="wrapper">
#{navigationBar /}

<div class="middle">

#{ifErrors}
	<h1>Oops...</h1>
	#{errors}
		<li>${error}</li>
	#{/errors}
#{/ifErrors}

<div style="width:100%; float: left">
<table cellpadding="10px">
	<tr>
	#{form @InternJobSeekerController.updateProfilePhoto(), enctype:'multipart/form-data'}
	
    	<td width="120px">
            Profile photo: 
        </td>
        <td>
        	<div style="width:100%; padding-bottom:10px">
                #{if jobSeeker?.photo && jobSeeker?.photo.exists()}
                    <img src="@{Application.jobSeekerPhoto(jobSeeker.id)}" />
                #{/if}
                #{else}
                    none
                #{/else}
            </div>
            <div style="width: 100%">
                <input type="file" name="jobSeeker.photo" />
                <span class="error">#{error 'jobSeeker.photo' /}</span>
                <input type="submit" value="Upload" />
            </div>
        </td>
	
	#{/form}
	</tr>
    
    <tr>
	#{form @InternJobSeekerController.updateProfile(), enctype:'multipart/form-data'}
		<td>
        	Email:
        </td>
        <td>
            <input type="text" name="jobSeeker.email" value="#{ifErrors}${flash['jobSeeker.email']}#{/ifErrors}#{else}${jobSeeker.email}#{/else}" />
			<span class="error">#{error 'jobSeeker.email' /}</span>
        </td>
    </tr>
	
	<tr>
    	<td>
			Password:
        </td>
        <td>
        	 <input type="password" name="jobSeeker.password" value="#{ifErrors}${flash['jobSeeker.password']}#{/ifErrors}#{else}${jobSeeker.password}#{/else}" />
			<span class="error">#{error 'jobSeeker.password' /}</span>
		</td>
	</tr>
    <tr>
    	<td>
			Full name:
        </td>
        <td>
        	<input type="text" name="jobSeeker.fullName" value="#{ifErrors}${flash['jobSeeker.fullName']}#{/ifErrors}#{else}${jobSeeker.fullName}#{/else}" />
		<span class="error">#{error 'jobSeeker.fullName' /}</span>
		</td>
    </tr>
	<tr>
    	<td>
			Birthday (yyyy-mm-dd):
        </td>
        <td>
			<input type="text" name="jobSeeker.birthday" value="#{ifErrors}${flash['jobSeeker.birthday']}#{/ifErrors}#{else}${jobSeeker.birthday}#{/else}" />
		<span class="error">#{error 'jobSeeker.birthday' /}</span>
        </td>
	</tr>
	<tr>
    	<td>
			About me:
        </td>
        <td>
        	<textarea style="width: 400px; height: 200px" name="jobSeeker.aboutMe">#{ifErrors}${flash['jobSeeker.aboutMe']}#{/ifErrors}#{else}${jobSeeker.aboutMe}#{/else}</textarea>
			<span class="error">#{error 'jobSeeker.aboutMe' /}</span>
		</td>
	</tr>
    <tr>
    	<td>
			College:
        </td>
        <td>
        	<input type="text" name="jobSeeker.college" value="#{ifErrors}${flash['jobSeeker.college']}#{/ifErrors}#{else}${jobSeeker.college}#{/else}" />
		<span class="error">#{error 'jobSeeker.college' /}</span>
		</td>
	</tr>
    <tr>
    	<td>
			<strong>Contact Info:</strong>
        </td>
        <td>
			<span class="error">#{error 'contactInfo' /}</span>
        </td>
    </tr>
	<tr>
    	<td>
			Contact email:
        </td>
        <td>
        	<input type="text" name="jobSeeker.contactInfo.contactEmail" value="#{ifErrors}${flash['jobSeeker.contactInfo.contactEmail']}#{/ifErrors}#{else}${jobSeeker.contactInfo.contactEmail}#{/else}" />
			<span class="error">#{error 'jobSeeker.contactInfo.contactEmail' /}</span>
		</td>
    </tr>
    <tr>
		<td>
			Mobile:
        </td>
        <td>
       		<input type="text" name="jobSeeker.contactInfo.mobile" value="#{ifErrors}${flash['jobSeeker.contactInfo.mobile']}#{/ifErrors}#{else}${jobSeeker.contactInfo.mobile}#{/else}" />
			<span class="error">#{error 'jobSeeker.contactInfo.mobile' /}</span>
		</td>
    </tr>
    <tr>
		<td>
			Phone:
        </td>
        <td>
        	<input type="text" name="jobSeeker.contactInfo.phone" value="#{ifErrors}${flash['jobSeeker.contactInfo.phone']}#{/ifErrors}#{else}${jobSeeker.contactInfo.phone}#{/else}" />
			<span class="error">#{error 'jobSeeker.contactInfo.phone' /}</span>
		</td>
    </tr>
	<tr>
    	<td>
			Address:
        </td>
        <td>
        <input type="text" name="jobSeeker.contactInfo.address.address" value="#{ifErrors}${flash['jobSeeker.contactInfo.address.address']}#{/ifErrors}#{elseif jobSeeker.contactInfo.address?.address}${jobSeeker.contactInfo.address.address}#{/elseif}" />
			<span class="error">#{error 'jobSeeker.contactInfo.address.address' /}</span>
		</td>
    </tr>
	<tr>
    	<td>
			City:
        </td>
        <td>
        	<select id="citySelect" name="jobSeeker.contactInfo.address.city.id">				
				#{list items:models.InternCity.all().fetch(), as:'city'}
					<option value=${city.id} 
						#{ifErrors}
							#{if Long.parseLong(flash['jobSeeker.contactInfo.address.city.id']) == (city.id)}
								selected=true
							#{/if}
						#{/ifErrors}
						#{elseif jobSeeker.contactInfo.address.city?.id==city.id}
							selected=true
						#{/elseif}
					>${city}</option>
				#{/list}
			</select>
		</td>
    </tr>
    <tr>
    	<td>
			District:
        </td>
        <td>
        	<select id="districtSelect" name="jobSeeker.contactInfo.address.district.id">
				#{list items:districts, as:'district'}
					<option value=${district.id}
						#{ifErrors}
							#{if Long.parseLong(flash['jobSeeker.contactInfo.address.district.id']) == (district.id)}
								selected=true
							#{/if}
						#{/ifErrors}
						#{elseif jobSeeker.contactInfo.address.district?.id==district.id}
							selected=true
						#{/elseif}
					>${district.name}</option>
				#{/list}
			</select>
        </td>
	</tr>
</table>
</div>

	<div style="width:100%; float: left; text-align:justify; padding-top:20px; padding-bottom:20px; padding-left:10px">
        <input  type="submit" value="Save" />
    </div>	

	<script type="text/javascript">
		var districtAction = #{jsAction @Application.districtsForCity(':cityId') /}
		
		$('#citySelect').change(function() {
			$.get(districtAction({cityId: $('#citySelect').val()}), function(districts) {	
				$('#districtSelect option').remove();
				$.each(districts, function(index, district) {
					$("#districtSelect").append('<option value="' + district.id + '">' + district.name + "</option>");
					});
				});
		});
	</script>
    
#{/form}

</div>
</div>

	<div style="height: 40px; width:100%; float: left"> </div>
	<!--Footer-->
    #{footer /}
